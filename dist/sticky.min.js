/*!
 * @autots/sticky v0.0.1
 * Last Modified @ 2019-9-5 10:08:57 AM
 * Released under the MIT License.
 */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.Sticky=e():(t.AutoTs=t.AutoTs||{},t.AutoTs.Sticky=e())}(this,function(){return function(t){var e={};function o(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,o),i.l=!0,i.exports}return o.m=t,o.c=e,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)o.d(n,i,function(e){return t[e]}.bind(null,i));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="",o(o.s=0)}([function(t,e,o){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(t){for(var e,o=1,n=arguments.length;o<n;o++)for(var i in e=arguments[o])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var i,r=!1;!function(){for(var t=["","-webkit-","-ms-","-moz-","-o-"],e=t.length,o=document.createElement("div"),n=0;n<e;n++)if(o.style.position=t[n]+"sticky",""!==o.style.position)return r=!0,void(i=t[n]);r=!1}();var s=function(){function t(e,o){var i=this;this.el=e,this.customCfg=o,this._scrollListener=function(){if(i.scrollContainer===window)i._setScrollPosition(i.targets);else{for(var t=0,e=i.targets;e!==i.scrollContainer&&null!==e;)t+=e.offsetTop,e=e.offsetParent;i.currentEleOffsetTop=t,i._setInnerScrollPosition(i.targets)}},this._throttle=function(t,e){var o,n,i,r,s;function l(){t.apply(r,s),n=o}return void 0===e&&(e=16),function(){for(var t=[],f=0;f<arguments.length;f++)t[f]=arguments[f];if(r=this,s=t,o=Date.now(),i&&(clearTimeout(i),i=null),n){var c=e-(o-n);c<0?l():i=setTimeout(function(){l()},c)}else l()}},e?("string"==typeof e?this.targets=document.querySelector(e):e instanceof HTMLElement?this.targets=e:(e instanceof HTMLCollection||e instanceof NodeList)&&e.length&&(this.targets=e[0]),this.targets?(this.config=n(n({},t.defaultConfig),o),this._init()):console.error(new Error("Sticky 初始化失败，无法获取到有效的被监听元素"))):console.error(new Error("Sticky 初始化错误，缺少必要的选择器参数"))}return t.prototype._init=function(){var t=this,e=this.config;if(r)this._setCssSticky();else{var o;if(e.throttle?this.listener=this._throttle(this._scrollListener):this.listener=this._scrollListener,e.scrollContainer===window||e.scrollContainer===document)o=window;else if("string"==typeof e.scrollContainer)o=document.querySelector(e.scrollContainer);else if(e.scrollContainer instanceof HTMLElement)o=e.scrollContainer;else if(e.scrollContainer instanceof NodeList||e.scrollContainer instanceof HTMLCollection){Array.prototype.slice.apply(e.scrollContainer).forEach(function(e){e.contains(t.targets)&&(o=e)})}o||console.error(new Error("无效的 scrollContainer")),this.scrollContainer=o,o.addEventListener("scroll",this.listener,!1)}},t.prototype._setCssSticky=function(){var t=this.config,e=this.targets;e.style.position=i+"sticky",e.style.top=t.top+"px",e.style.zIndex=t.zIndex.toString()},t.prototype._setScrollPosition=function(t){var e=t.firstElementChild,o=this.config,n=t.offsetTop,i=t.getBoundingClientRect().top,r=t.offsetParent.offsetHeight,s=e.style;if(i<=o.top){var l=parseInt(t.style.height);l&&l===e.offsetHeight||(t.style.height=e.offsetHeight+"px"),r-n-t.offsetHeight-Math.abs(i)<0?(s.position="absolute",s.bottom="0px",s.top=""):(s.position="fixed",s.bottom="",s.top=o.top+"px"),s.zIndex=o.zIndex.toString()}else s.position="static"},t.prototype._setInnerScrollPosition=function(t){var e=t.offsetParent,o=t.firstElementChild,n=this.scrollContainer,i=t.offsetHeight,r=e.offsetHeight,s=n.scrollTop;s<=this.currentEleOffsetTop?o.style.position="":s<r-i+this.currentEleOffsetTop?(o.style.position="absolute",o.style.top=s-this.currentEleOffsetTop+this.config.top+"px",o.style.bottom=""):s<r+this.currentEleOffsetTop?(o.style.position="absolute",o.style.bottom="0px",o.style.top=""):o.style.position="",o.style.zIndex=this.config.zIndex.toString()},t.prototype.destory=function(){var t=this;this.listener&&window.removeEventListener("scroll",this.listener,!1),setTimeout(function(){t._resetStyle()},100)},t.prototype._resetStyle=function(){var t=this.targets;if(r)t.style.position="",t.style.top="",t.style.zIndex="";else{var e=t.firstElementChild;t.style.height="",e.style.position="",e.style.top="",e.style.bottom="",e.style.zIndex=""}},t.defaultConfig={scrollContainer:window,top:0,zIndex:100,throttle:!1},t}();e.default=s}]).default});